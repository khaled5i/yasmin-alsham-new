# ๐ง ุฅุตูุงุญ ูุดููุฉ ุนุฏู ุธููุฑ ุงููุณุงุชูู ุงูุฌุฏูุฏุฉ ูู ุงููุชุฌุฑ

## ๐ ููุฎุต ุงููุดููุฉ

ุนูุฏ ุฅุถุงูุฉ ูุณุชุงู ุฌุฏูุฏ ูู ููุญุฉ ุงูุชุญูู (`/dashboard/ready-designs`)ุ ุงููุณุชุงู **ูุง ูุธูุฑ** ูู ุตูุญุฉ ุงููุชุฌุฑ (`/designs`) ุฑุบู ูุฌูุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

---

## ๐ ุงูุณุจุจ ุงูุฌุฐุฑู

ุชู ุงูุชุดุงู **3 ุฃุณุจุงุจ ุฑุฆูุณูุฉ**:

### 1๏ธโฃ ุณูุงุณุฉ RLS ุชุชุทูุจ `published_at IS NOT NULL`
- ุงูุณูุงุณุฉ ุงูุฃุตููุฉ ูู `migrations/04-store-migration.sql` ูุงูุช:
  ```sql
  USING (is_available = true AND published_at IS NOT NULL AND published_at <= NOW())
  ```
- ุงููุดููุฉ: ุนูุฏ ุฅุถุงูุฉ ูุณุชุงู ุฌุฏูุฏุ ุญูู `published_at` ูููู `NULL`
- ุงููุชูุฌุฉ: ุงููุณุชุงู **ูุง ูุธูุฑ** ูููุณุชุฎุฏููู ุบูุฑ ุงููุณุฌููู

### 2๏ธโฃ ููุฏ ููุญุฉ ุงูุชุญูู ูุง ูุถูู `published_at`
- ุงูููุฏ ูู `src/app/dashboard/ready-designs/page.tsx` ูู ููู ูุถูู `published_at`
- ุงููุชูุฌุฉ: ุฌููุน ุงููุณุงุชูู ุงูุฌุฏูุฏุฉ ุชููุดุฃ ุจู `published_at = NULL`

### 3๏ธโฃ ุนุฏู ุชุญุฏูุซ ุงููุชุฌุฑ ุงูุฃูุงูู ุชููุงุฆูุงู
- ุจุนุฏ ุฅุถุงูุฉ ูุณุชุงู ุฌุฏูุฏุ ุงููุชุฌุฑ ุงูุฃูุงูู ูุง ูุชุญุฏุซ ุชููุงุฆูุงู
- ุงููุชูุฌุฉ: ุญุชู ุจุนุฏ ุงูุฅุตูุงุญุ ุงููุณุชุฎุฏู ูุญุชุงุฌ ูุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ูุฏููุงู

---

## โ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### โ ุฅุตูุงุญ 1: ุชุนุฏูู ููุฏ ููุญุฉ ุงูุชุญูู (ุชู ุชููุงุฆูุงู)

**ุงูููู:** `src/app/dashboard/ready-designs/page.tsx`

**ุงูุชุนุฏูู:**
```typescript
const createData: CreateProductData = {
  // ... ุจุงูู ุงูุญููู
  published_at: new Date().toISOString(), // โ ุฅุถุงูุฉ ุชุงุฑูุฎ ุงููุดุฑ ุชููุงุฆูุงู
}
```

**ุงููุชูุฌุฉ:** ุฌููุน ุงููุณุงุชูู ุงูุฌุฏูุฏุฉ ุณุชุญุตู ุนูู ุชุงุฑูุฎ ูุดุฑ ููุฑุงู

---

### โ ุฅุตูุงุญ 2: ุชุญุฏูุซ ุงููุชุฌุฑ ุชููุงุฆูุงู (ุชู ุชููุงุฆูุงู)

**ุงูููู:** `src/app/dashboard/ready-designs/page.tsx`

**ุงูุชุนุฏูู:**
```typescript
if (data) {
  console.log('โ ุชู ุฅุถุงูุฉ ุงูููุชุฌ ุจูุฌุงุญ')
  setProducts(prev => [data, ...prev])
  
  // โ ุชุญุฏูุซ ุงููุชุฌุฑ ุงูุฃูุงูู
  try {
    const { useShopStore } = await import('@/store/shopStore')
    const { loadProducts } = useShopStore.getState()
    await loadProducts(true) // forceReload = true
  } catch (err) {
    console.warn('โ๏ธ ูุดู ุชุญุฏูุซ ุงููุชุฌุฑ ุงูุฃูุงูู:', err)
  }
  
  setSuccess(true)
}
```

**ุงููุชูุฌุฉ:** ุงููุชุฌุฑ ูุชุญุฏุซ ุชููุงุฆูุงู ุจุนุฏ ุฅุถุงูุฉ ูุณุชุงู ุฌุฏูุฏ

---

### ๐ด ุฅุตูุงุญ 3: ุชุญุฏูุซ ุณูุงุณุฉ RLS (ูุชุทูุจ ุชุทุจูู ูุฏูู)

**ูุฌุจ ุนููู ุชุทุจูู ูุฐุง ุนูู Supabase:**

1. ุงูุชุญ **Supabase Dashboard** โ **SQL Editor**
2. ููุฐ ูุฐุง ุงูููุฏ:

```sql
-- ุญุฐู ุงูุณูุงุณุฉ ุงููุฏููุฉ
DROP POLICY IF EXISTS "Anyone can view available products" ON public.products;

-- ุฅูุดุงุก ุงูุณูุงุณุฉ ุงูุฌุฏูุฏุฉ
CREATE POLICY "Anyone can view available products"
  ON public.products
  FOR SELECT
  USING (
    is_available = true
    AND (
      published_at IS NULL  -- โ ุงูุณูุงุญ ุจุงูููุชุฌุงุช ุจุฏูู ุชุงุฑูุฎ ูุดุฑ
      OR published_at <= NOW()
    )
  );

-- ุชุญุฏูุซ ุงูููุชุฌุงุช ุงูููุฌูุฏุฉ
UPDATE public.products 
SET published_at = created_at 
WHERE published_at IS NULL AND is_available = true;

-- ููุญ ุงูุตูุงุญูุงุช
GRANT SELECT ON public.products TO anon;
GRANT SELECT ON public.categories TO anon;
```

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู

### ุงูุฎุทูุฉ 1: ุชุทุจูู ุณูุฑูุจุช SQL (ุฅูุฒุงูู)

1. ุงูุชุญ Supabase Dashboard
2. ุงุฐูุจ ุฅูู **SQL Editor**
3. ุงูุชุญ ุงูููู `SUPABASE_FIX_INSTRUCTIONS.sql`
4. ุงูุณุฎ **ุงูุฎุทูุงุช 2 ู 3 ู 5** (ุงูุณุทูุฑ 28-73)
5. ุงูุตู ูู SQL Editor ูุงุถุบุท **Run**

### ุงูุฎุทูุฉ 2: ุงุฎุชุจุงุฑ ุงูุฅุตูุงุญ

1. ุงูุชุญ ููุญุฉ ุงูุชุญูู: `http://localhost:3001/dashboard/ready-designs`
2. ุฃุถู ูุณุชุงู ุฌุฏูุฏ
3. ุงูุชุญ ุตูุญุฉ ุงููุชุฌุฑ: `http://localhost:3001/designs`
4. ุชุญูู ูู ุธููุฑ ุงููุณุชุงู ุงูุฌุฏูุฏ

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ูุถุน Incognito

1. ุงูุชุญ ูุงูุฐุฉ Incognito (Ctrl+Shift+N)
2. ุงูุชูู ุฅูู: `http://localhost:3001/designs`
3. ุชุญูู ูู ุธููุฑ ุฌููุน ุงููุณุงุชูู

---

## ๐งช ุงูุงุฎุชุจุงุฑ

ุฑุงุฌุน ุงูููู `TESTING_CHECKLIST.md` ููุญุตูู ุนูู ูุงุฆูุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ.

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### ูููุงุช ุชู ุชุนุฏูููุง ุชููุงุฆูุงู:
- โ `src/app/dashboard/ready-designs/page.tsx` (ุงูุณุทุฑ 233 ู 256-264)

### ูููุงุช ุฌุฏูุฏุฉ ุชู ุฅูุดุงุคูุง:
- โ `SUPABASE_FIX_INSTRUCTIONS.sql` - ุณูุฑูุจุช SQL ููุชุทุจูู ุนูู Supabase
- โ `TESTING_CHECKLIST.md` - ูุงุฆูุฉ ุงุฎุชุจุงุฑ ุดุงููุฉ
- โ `README_FIX_AR.md` - ูุฐุง ุงูููู

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุทุจูู ุฌููุน ุงูุฅุตูุงุญุงุช:

โ ุงููุณุงุชูู ุงูุฌุฏูุฏุฉ ุชุธูุฑ **ููุฑุงู** ูู ุงููุชุฌุฑ  
โ ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ูุฏููุงู  
โ ุงููุณุชุฎุฏููู ุบูุฑ ุงููุณุฌููู ูููููู ุฑุคูุฉ ุฌููุน ุงููุณุงุชูู  
โ ููุญุฉ ุงูุชุญูู ุชุนูู ุจุณูุงุณุฉ  

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ุงููุณุชุงู ูุง ูุฒุงู ูุง ูุธูุฑ

**ุงูุญู:**
1. ุชุฃูุฏ ูู ุชุทุจูู ุณูุฑูุจุช SQL ุนูู Supabase
2. ุงูุณุญ cache ุงููุชุตูุญ (Ctrl+Shift+R)
3. ุชุญูู ูู Console (F12) ููุฃุฎุทุงุก
4. ูู ุจุชุดุบูู ูุฐุง ุงูุงุณุชุนูุงู ูู Supabase:
   ```sql
   SELECT id, title, is_available, published_at 
   FROM public.products 
   ORDER BY created_at DESC 
   LIMIT 5;
   ```

### ุงููุดููุฉ: ุฎุทุฃ RLS ูู Console

**ุงูุญู:**
- ุชุฃูุฏ ูู ุชุทุจูู ุณูุฑูุจุช SQL ุจุงููุงูู
- ุชุญูู ูู ุณูุงุณุฉ RLS:
  ```sql
  SELECT policyname, qual 
  FROM pg_policies 
  WHERE tablename = 'products';
  ```

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุฑุงุฌุน `TESTING_CHECKLIST.md`
2. ุชุญูู ูู Console (F12)
3. ุชุญูู ูู Supabase Logs

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

- ุชู ุงูุงุญุชูุงุธ ุจุฌููุน ุงููููุงุช ุงูุฃุตููุฉ
- ุงูุชุนุฏููุงุช ูุชูุงููุฉ ูุน ุงูููุฏ ุงูุญุงูู
- ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุงุฏู (Next.js ุณูุชุญุฏุซ ุชููุงุฆูุงู)
- ุงูุฅุตูุงุญุงุช ูุง ุชุคุซุฑ ุนูู ุงููุธุงุฆู ุงูุฃุฎุฑู

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ:** 2025-11-08  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุชุทุจูู

