-- ============================================================================
-- Migration: إضافة حقل موعد تسليم البروفا (Proof Delivery Date)
-- التاريخ: 2025-01-28
-- الوصف: إضافة حقل proof_delivery_date إلى جدول orders
-- ============================================================================

-- ============================================================================
-- 1. إضافة حقل موعد تسليم البروفا
-- ============================================================================

-- إضافة حقل proof_delivery_date (اختياري)
ALTER TABLE orders 
ADD COLUMN IF NOT EXISTS proof_delivery_date DATE;

-- ============================================================================
-- 2. إضافة فهرس للبحث السريع
-- ============================================================================

-- إنشاء فهرس على proof_delivery_date لتحسين أداء الاستعلامات
CREATE INDEX IF NOT EXISTS idx_orders_proof_delivery_date 
ON orders(proof_delivery_date) 
WHERE proof_delivery_date IS NOT NULL;

-- ============================================================================
-- 3. التعليقات التوضيحية
-- ============================================================================

COMMENT ON COLUMN orders.proof_delivery_date IS 'موعد تسليم البروفا للعميل (اختياري) - يُستخدم لجدولة مواعيد البروفا';

-- ============================================================================
-- 4. ملاحظات
-- ============================================================================

-- الحقل اختياري (nullable) - يمكن أن يكون NULL
-- يُستخدم لجدولة مواعيد البروفا المنفصلة عن موعد التسليم النهائي
-- يتم عرض عدد مواعيد البروفا في التقويم الأخضر
-- التحذير يظهر عند وجود 4 مواعيد بروفا أو أكثر في نفس اليوم

